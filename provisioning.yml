---
- hosts: all
  handlers:
      - name: restart apache
        become: yes
        service:
          name: apache2
          state: reloaded
  tasks:
    - name: Instalando dependencias do WordPress
      become: yes
      apt:
        update_cache: yes
        pkg:
          - apache2
          - ghostscript
          - libapache2-mod-php
          - mysql-server
          - php
          - php-bcmath
          - php-curl
          - php-imagick
          - php-intl
          - php-json
          - php-mbstring
          - php-mysql
          - php-xml
          - php-zip
        state: latest
    - name: Criando diretorio do WordPress
      become: yes
      file:
        path: /srv/www
        state: directory
        owner: www-data
        group: www-data
    - name: Baixando e extraindo o WordPress
      become: yes
      unarchive:
        src: https://wordpress.org/latest.tar.gz
        dest: /srv/www
        remote_src: yes
    - name: Copiar configuração do WordPress para o servidor
      become: yes
      ansible.builtin.copy:
        src: files/wordpress.conf
        dest: /etc/apache2/sites-available/000-default.conf
      notify:
        - restart apache